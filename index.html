<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Expense Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body class="bg-gradient-to-tl from-purple-400 to-pink-300 min-h-screen flex justify-center items-center py-10">
    <div class="container bg-white rounded-lg shadow-md p-6 w-4/5 max-w-2xl">
        <h1 class="text-2xl font-semibold text-center text-gray-800 mb-4 bg-gradient-to-r from-indigo-300 to-blue-300 bg-clip-text text-transparent">Family Expense Tracker</h1>

        <div id="expense-form" class="mb-4 p-4 bg-white/80 backdrop-blur-md rounded-lg shadow-inner">
            <h2 class="text-xl font-semibold text-gray-700 mb-3">Add Expense</h2>
            <form>
                <div class="mb-2">
                    <label for="name" class="block text-gray-600 text-sm font-bold mb-2">Name:</label>
                    <input type="text" id="name" name="name" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-2">
                    <label for="category" class="block text-gray-600 text-sm font-bold mb-2">Category:</label>
                    <select id="category" name="category" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="" disabled selected>Select Category</option>
                        <option value="food">Food</option>
                        <option value="housing">Housing</option>
                        <option value="transport">Transport</option>
                        <option value="utilities">Utilities</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="mb-2">
                    <label for="amount" class="block text-gray-600 text-sm font-bold mb-2">Amount:</label>
                    <input type="number" id="amount" name="amount" required min="0" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-2">
                    <label for="month" class="block text-gray-600 text-sm font-bold mb-2">Month:</label>
                    <input type="month" id="month" name="month" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <button type="submit" class="bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Add Expense</button>
            </form>
        </div>

        <div id="summary" class="mb-4 p-4 bg-white/80 backdrop-blur-md rounded-lg shadow-inner">
            <h2 class="text-xl font-semibold text-gray-700 mb-3">Monthly Summary</h2>
            <div id="summary-content" class="text-gray-800">
                <p>No expenses added yet for the selected month.</p>
            </div>
        </div>

        <div id="message-box" class="mt-4 p-3 bg-white/80 backdrop-blur-md rounded-lg shadow-inner text-center text-gray-700">
            <p id="message-text"></p>
        </div>
    </div>

    <script>
        const expenseForm = document.querySelector('#expense-form form');
        const summaryContent = document.querySelector('#summary-content');
        const messageBox = document.querySelector('#message-box');
        const messageText = document.querySelector('#message-text');

        let expenses = [];

        // Google Sheets API configuration
        const SPREADSHEET_ID = '1iJabDMBsdecEvijOC5eKwDnH0jHaluEGtMU8_2veplw';
        const SHEET_NAME = 'Sheet1';
        const CLIENT_ID = '520182439205-lv53p2amhtj0qceji9d3gl3crm7efhqk.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyDSQyv22FC_NmfvbY7oSqfRXKQjB5m58eA';

        // Initialize Google API client
        function initClient() {
            gapi.load('client', () => {
                gapi.client.init({
                    apiKey: API_KEY,
                    clientId: CLIENT_ID,
                    discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                    scope: 'https://www.googleapis.com/auth/spreadsheets',
                }).then(() => {
                    console.log('Google Sheets API client initialized');
                    // You can call listMajors here if you want to test the connection
                    // listMajors();
                }).catch(err => {
                    console.error("Error initializing gapi client:", err);
                    displayMessage('Error initializing Google Sheets API. Check console for details.', 'error');
                });
            });
        }


        function displayMessage(message, type = 'success') {
            messageText.textContent = message;
            messageBox.className = `mt-4 p-3 rounded-lg text-center ${type === 'success' ? 'bg-green-100 text-green-800 border border-green-300' : 'bg-red-100 text-red-800 border border-red-300'}`;
        }

        function calculateSummary(month) {
            const monthlyExpenses = expenses.filter(expense => expense.month === month);
            if (monthlyExpenses.length === 0) {
                summaryContent.innerHTML = `<p class="text-gray-700">No expenses added yet for ${month}.</p>`;
                return;
            }

            let total = 0;
            const categoryTotals = {};
            const personTotals = {};

            monthlyExpenses.forEach(expense => {
                total += expense.amount;
                if (!categoryTotals[expense.category]) {
                    categoryTotals[expense.category] = 0;
                }
                categoryTotals[expense.category] += expense.amount;

                if (!personTotals[expense.name]) {
                    personTotals[expense.name] = 0;
                }
                personTotals[expense.name] += expense.amount;
            });

            let summaryHTML = `<h3 class="text-lg font-semibold mb-2 text-gray-800">Total Expenses for ${month}: <span class="text-blue-600 font-bold">${total.toFixed(2)}</span></h3>`;
            summaryHTML += `<h4 class="text-md font-semibold mt-3 mb-1 text-gray-800">Category Breakdown:</h4>`;
            for (const category in categoryTotals) {
                summaryHTML += `<p class="text-gray-700"><span class="font-medium capitalize">${category}:</span> <span class="text-green-600 font-bold">${categoryTotals[category].toFixed(2)}</span></p>`;
            }

            summaryHTML += `<h4 class="text-md font-semibold mt-3 mb-1 text-gray-800">Individual Contributions:</h4>`;
             for (const person in personTotals) {
                summaryHTML += `<p class="text-gray-700"><span class="font-medium">${person}:</span> <span class="text-purple-600 font-bold">${personTotals[person].toFixed(2)}</span></p>`;
            }
            summaryContent.innerHTML = summaryHTML;
        }

        expenseForm.addEventListener('submit', (event) => {
            event.preventDefault();

            const name = event.target.name.value.trim();
            const category = event.target.category.value;
            const amount = parseFloat(event.target.amount.value);
            const month = event.target.month.value;

            if (!name || !category || isNaN(amount) || amount <= 0 || !month) {
                displayMessage('Please fill out all fields with valid values.', 'error');
                return;
            }

            const newExpense = { name, category, amount, month };
            expenses.push(newExpense);
            displayMessage('Expense added successfully!  Submitting to Google Sheets...', 'success');
            event.target.reset();
            calculateSummary(month);
            appendDataToSheet(newExpense); // Send data to Google Sheets
        });

        function appendDataToSheet(expense) {
            const { name, category, amount, month } = expense;
            const values = [[name, category, amount, month]];
            const body = {
                values: values,
            };
            gapi.client.sheets.spreadsheets.values.append({
                spreadsheetId: SPREADSHEET_ID,
                range: SHEET_NAME,
                valueInputOption: 'RAW',
                insertDataOption: 'INSERT_ROWS',
                resource: body,
            }).then((response) => {
                console.log('Data appended to Google Sheets:', response);
                displayMessage('Expense added to Google Sheets successfully!', 'success');
            }).catch((error) => {
                console.error('Error appending data to Google Sheets:', error);
                displayMessage('Error adding expense to Google Sheets. Check console for details.', 'error');
            });
        }

        // Simulate sending SMS reminders (for demonstration purposes)
        function sendSMSReminder(name, month) {
            // In a real application, you would use an SMS gateway API (e.g., Twilio)
            console.log(`Sending SMS reminder to ${name} for ${month} expenses...`);
            //  Replace this with actual SMS sending logic using an API like Twilio
            // twilioClient.messages
            //   .create({
            //      body: `Hi ${name}, this is a friendly reminder to submit your expenses for ${month}.`,
            //      from: '+1234567890', // Your Twilio phone number
            //      to: '+11234567890'  // The recipient's phone number
            //    })
            //   .then(message => console.log(message.sid))
            //   .catch(error => console.error(error));
        }

        // Simulate checking for missing expenses and sending reminders
        function checkAndRemind() {
            if (expenses.length === 0) return;
            const currentMonth = new Date().toISOString().slice(0, 7);
            const familyMembers = new Set(expenses.map(expense => expense.name));
            const expensesThisMonth = expenses.filter(expense => expense.month === currentMonth);
            const membersWhoSubmitted = new Set(expensesThisMonth.map(expense => expense.name));

            familyMembers.forEach(member => {
                if (!membersWhoSubmitted.has(member)) {
                    sendSMSReminder(member, currentMonth);
                }
            });
        }

        // Run the checkAndRemind function periodically (e.g., daily)
        setInterval(checkAndRemind, 24 * 60 * 60 * 1000); // Check daily

        // Load Google Sheets API and initialize the client
        gapi.load('client', initClient);

    </script>
</body>
</html>
```
I've made the following changes:

* **Moved gapi.load inside initClient:** The `gapi.load` function is now inside the `initClient` function. This ensures that the Google API client is loaded before any attempt to use it.

This revised code should resolve the error and correctly initialize the Google Sheets API clie
